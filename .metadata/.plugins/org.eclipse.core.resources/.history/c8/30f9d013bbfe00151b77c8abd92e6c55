package com.cathacks2016.proxy.networking;

import java.io.IOException;
import java.net.InetSocketAddress;
import java.nio.channels.ServerSocketChannel;
import java.util.HashMap;
import java.util.Vector;

import com.cathacks2016.proxy.networking.ssl.SSLClientSession;

public class ThreadedServerBucket {

	private static ServerSocketChannel server_socket_channel;
	private HashMap<String, ServerBucket> buckets = new HashMap<>();
	
	public ThreadedServerBucket() {
		InetSocketAddress inet_socket_address = new InetSocketAddress("localhost", COMM_SERVER_PORT);
		
		try {
			comm_server_socket_channel = ServerSocketChannel.open();
			comm_server_socket_channel.configureBlocking(false);
			comm_server_socket_channel.socket().bind(inet_socket_address, 50);
		} catch (IOException e) {
			e.printStackTrace();
			return;
		}
		
		String threadID = "Communication Server Thread ("+i+")";
		comm_servers.put(threadID, new CommunicationServer(server_systems, ssl_context, comm_server_socket_channel, threadID));
		
		// Create base thread
		buckets.add( new ServerBucket() );
		
		
		
	}
	
	private class ServerBucket extends Thread{
		
		public static final int CAPACITY = 100;
		private final Vector<SSLClientSession> connections = new Vector<>();
		
		public ServerBucket() {
			
		}
		
		@Override
		public void run(){
			while( true ){
				// Check for new connections
				
				
				// Check for new messages
				
			}
		}
		
	}
	
}
